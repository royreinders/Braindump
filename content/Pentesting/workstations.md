---
title: "Workstations"
date: 2020-07-16T13:41:37+02:00
draft: true
---


#### Search for cpassword entries in group policies

```findstr /S /I cpassword \\<FQDN>\sysvol\<FQDN>\policies\*.xml'```

***


#### Get the DC from a Domain Joines machine

PowerShell:
```
$env:LOGONSERVER
```
CMD:
```
echo %logonserver%
```
***

#### Using PowerView to enumerate Shares, Admin access and more (ToDo)
https://book.hacktricks.xyz/windows/basic-powershell-for-pentesters/powerview

#### Check whether constrained language mode is enabled
PowerShell Constrained Language is a language mode of PowerShell designed to support day-to-day administrative tasks, yet restrict access to sensitive language elements that can be used to invoke arbitrary Windows APIs. The used language mode van be checked with the following command:

```powershell
PS C:\> $ExecutionContext.SessionState.LanguageMode
FullLanguage
```

#### Check whether WSUS uses a secure channel
WSUS updates should be pulled in through HTTPS. Use the following reg query command to check the WSUS settings.

```$reg query HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate```

#### PowerShell downgrade possibilities
Older PowerShell versions might not have advanced protection applied to them (like AMSI). Therefore, for an attacker it can be usefull to use an older version of PowerShell to evade detection. Check supported PowerShell versions with the following command.
```echo $PSVersionTable```

Simply run PowerShell using an older version as follows (example with PowerShell version 2).
```powershell.exe -Version 2```